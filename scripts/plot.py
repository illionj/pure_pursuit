import re
import numpy as np
import math
import matplotlib.pyplot as plt
from scipy.signal import savgol_filter   # 可选：给导数做平滑
import pandas as pd
with open("log.txt", "r", encoding="utf-8") as f:
    content = f.read()
log = content

# log = """
# State(x=0.277778, y=0.000000, yaw=0.033025, v=2.777778, rear_x=-1.171432, rear_y=-0.047878)
# State(x=0.555404, y=0.009172, yaw=0.064708, v=2.777778, rear_x=-0.891561, rear_y=-0.084589)
# State(x=0.832601, y=0.027134, yaw=0.095201, v=2.777778, rear_x=-0.610834, rear_y=-0.110700)
# State(x=1.109120, y=0.053539, yaw=0.124657, v=2.777778, rear_x=-0.329628, rear_y=-0.126746)
# State(x=1.384743, y=0.088076, yaw=0.153224, v=2.777778, rear_x=-0.048269, rear_y=-0.133230)
# State(x=1.659266, y=0.130472, yaw=0.181054, v=2.777778, rear_x=0.232967, rear_y=-0.130624)
# State(x=1.932504, y=0.180490, yaw=0.208300, v=2.777778, rear_x=0.513847, rear_y=-0.119365)
# State(x=2.204277, y=0.237934, yaw=0.237267, v=2.777778, rear_x=0.794900, rear_y=-0.102884)
# State(x=2.474272, y=0.303225, yaw=0.267159, v=2.777778, rear_x=1.075712, rear_y=-0.079565)
# State(x=2.742196, y=0.376556, yaw=0.296194, v=2.777778, rear_x=1.355337, rear_y=-0.046673)
# State(x=3.007878, y=0.457634, yaw=0.325304, v=2.777778, rear_x=1.633925, rear_y=-0.005782)
# State(x=3.271087, y=0.546411, yaw=0.353536, v=2.777778, rear_x=1.910763, rear_y=0.044396)
# State(x=3.531686, y=0.642582, yaw=0.381021, v=2.777778, rear_x=2.185672, rear_y=0.103373)
# State(x=3.789543, y=0.745879, yaw=0.407640, v=2.777778, rear_x=2.458357, rear_y=0.171035)
# State(x=4.044559, y=0.856003, yaw=0.432738, v=2.777778, rear_x=2.728218, rear_y=0.247934)
# State(x=4.296731, y=0.972491, yaw=0.457018, v=2.777778, rear_x=2.995542, rear_y=0.332643)
# State(x=4.546002, y=1.095067, yaw=0.479056, v=2.777778, rear_x=3.259227, rear_y=0.426702)
# State(x=4.792510, y=1.223106, yaw=0.500361, v=2.777778, rear_x=3.520266, rear_y=0.527480)
# State(x=5.036235, y=1.356368, yaw=0.521048, v=2.777778, rear_x=3.778653, rear_y=0.634574)
# State(x=5.277151, y=1.494643, yaw=0.541232, v=2.777778, rear_x=4.034393, rear_y=0.747614)
# State(x=5.515227, y=1.637752, yaw=0.561033, v=2.777778, rear_x=4.287503, rear_y=0.866263)
# State(x=5.750423, y=1.785547, yaw=0.573863, v=2.777778, rear_x=4.532698, rear_y=0.998371)
# State(x=5.983704, y=1.936347, yaw=0.586322, v=2.777778, rear_x=4.775881, rear_y=1.134060)
# State(x=6.215088, y=2.090041, yaw=0.594364, v=2.777778, rear_x=5.013755, rear_y=1.278068)
# State(x=6.445228, y=2.245592, yaw=0.602181, v=2.777778, rear_x=5.250280, rear_y=1.424252)
# State(x=6.674145, y=2.402936, yaw=0.604916, v=2.777778, rear_x=5.481448, rear_y=1.578332)
# State(x=6.902631, y=2.560907, yaw=0.607579, v=2.777778, rear_x=5.712134, rear_y=1.733128)
# State(x=7.130696, y=2.719485, yaw=0.604450, v=2.777778, rear_x=5.937615, rear_y=1.895436)
# State(x=7.359256, y=2.877349, yaw=0.601397, v=2.777778, rear_x=6.163664, rear_y=2.056946)
# State(x=7.588296, y=3.034514, yaw=0.591783, v=2.777778, rear_x=6.384873, rear_y=2.225643)
# State(x=7.818837, y=3.189470, yaw=0.582378, v=2.777778, rear_x=6.607859, rear_y=2.391954)
# State(x=8.050825, y=3.342251, yaw=0.573122, v=2.777778, rear_x=6.832517, rear_y=2.555978)
# State(x=8.284217, y=3.492878, yaw=0.556067, v=2.777778, rear_x=7.052678, rear_y=2.727496)
# State(x=8.520145, y=3.639503, yaw=0.539231, v=2.777778, rear_x=7.275894, rear_y=2.894963)
# State(x=8.758507, y=3.782135, yaw=0.504992, v=2.777778, rear_x=7.489498, rear_y=3.080624)
# State(x=9.001612, y=3.916524, yaw=0.471440, v=2.777778, rear_x=7.709785, rear_y=3.257978)
# State(x=9.249088, y=4.042683, yaw=0.429277, v=2.777778, rear_x=7.930651, rear_y=3.439173)
# State(x=9.501662, y=4.158298, yaw=0.387941, v=2.777778, rear_x=8.159412, rear_y=3.609787)
# State(x=9.758798, y=4.263377, yaw=0.338266, v=2.777778, rear_x=8.390968, rear_y=3.782191)
# State(x=10.020835, y=4.355558, yaw=0.289624, v=2.777778, rear_x=8.631225, rear_y=3.941450)
# State(x=10.287044, y=4.434889, yaw=0.241784, v=2.777778, rear_x=8.879221, rear_y=4.087708)
# State(x=10.556741, y=4.501398, yaw=0.186399, v=2.777778, rear_x=9.131858, rear_y=4.232683)
# State(x=10.829708, y=4.552877, yaw=0.132117, v=2.777778, rear_x=9.392344, rear_y=4.361864)
# State(x=11.105065, y=4.589469, yaw=0.071863, v=2.777778, rear_x=9.658807, rear_y=4.485358)
# State(x=11.382125, y=4.609414, yaw=0.013086, v=2.777778, rear_x=9.932250, rear_y=4.590439)
# State(x=11.659879, y=4.613049, yaw=-0.049843, v=2.777778, rear_x=10.211680, rear_y=4.685291)
# State(x=11.937312, y=4.599209, yaw=-0.110902, v=2.777778, rear_x=10.496220, rear_y=4.759687)
# State(x=12.213384, y=4.568466, yaw=-0.170301, v=2.777778, rear_x=10.784360, rear_y=4.814211)
# State(x=12.487143, y=4.521389, yaw=-0.228257, v=2.777778, rear_x=11.074753, rear_y=4.849495)
# State(x=12.757716, y=4.458533, yaw=-0.288016, v=2.777778, rear_x=11.367442, rear_y=4.870406)
# State(x=13.024052, y=4.379630, yaw=-0.345942, v=2.777778, rear_x=11.659955, rear_y=4.871301)
# State(x=13.285373, y=4.285440, yaw=-0.402246, v=2.777778, rear_x=11.951106, rear_y=4.853096)
# State(x=13.540980, y=4.176694, yaw=-0.457145, v=2.777778, rear_x=12.239871, rear_y=4.816707)
# State(x=13.790234, y=4.054086, yaw=-0.511469, v=2.777778, rear_x=12.525795, rear_y=4.763801)
# State(x=14.032464, y=3.918126, yaw=-0.564055, v=2.777778, rear_x=12.807077, rear_y=4.693320)
# State(x=14.267212, y=3.769621, yaw=-0.614910, v=2.777778, rear_x=13.082815, rear_y=4.606103)
# State(x=14.494108, y=3.609375, yaw=-0.663808, v=2.777778, rear_x=13.352013, rear_y=4.502751)
# State(x=14.712900, y=3.438230, yaw=-0.710949, v=2.777778, rear_x=13.614173, rear_y=4.384433)
# State(x=14.923384, y=3.256966, yaw=-0.756530, v=2.777778, rear_x=13.868912, rear_y=4.252249)
# State(x=15.125391, y=3.066298, yaw=-0.800749, v=2.777778, rear_x=14.115945, rear_y=4.107221)
# State(x=15.318771, y=2.866888, yaw=-0.843808, v=2.777778, rear_x=14.355068, rear_y=3.950298)
# State(x=15.503388, y=2.659338, yaw=-0.882502, v=2.777778, rear_x=14.582318, rear_y=3.779217)
# State(x=15.679838, y=2.444802, yaw=-0.919893, v=2.777778, rear_x=14.801275, rear_y=3.598330)
# State(x=15.848146, y=2.223819, yaw=-0.956158, v=2.777778, rear_x=15.011984, rear_y=3.408443)
# State(x=16.008330, y=1.996880, yaw=-0.987444, v=2.777778, rear_x=15.209633, rear_y=3.207080)
# State(x=16.161337, y=1.765041, yaw=-1.017568, v=2.777778, rear_x=15.399453, rear_y=2.998748)
# State(x=16.307291, y=1.528698, yaw=-1.046679, v=2.777778, rear_x=15.581640, rear_y=2.784059)
# State(x=16.446305, y=1.288208, yaw=-1.070624, v=2.777778, rear_x=15.750919, rear_y=2.560583)
# State(x=16.579521, y=1.044458, yaw=-1.093606, v=2.777778, rear_x=15.913557, rear_y=2.332477)
# State(x=16.707100, y=0.797711, yaw=-1.115742, v=2.777778, rear_x=16.069808, rear_y=2.100154)
# State(x=16.829186, y=0.548201, yaw=-1.137147, v=2.777778, rear_x=16.219919, rear_y=1.863987)
# State(x=16.945904, y=0.296134, yaw=-1.157939, v=2.777778, rear_x=16.364123, rear_y=1.624303)
# State(x=17.057357, y=0.041696, yaw=-1.178232, v=2.777778, rear_x=16.502646, rear_y=1.381396)
# State(x=17.163623, y=-0.214952, yaw=-1.192192, v=2.777778, rear_x=16.627669, rear_y=1.132362)
# State(x=17.266296, y=-0.473057, yaw=-1.205706, v=2.777778, rear_x=16.748598, rear_y=0.881375)
# State(x=17.365472, y=-0.732527, yaw=-1.218850, v=2.777778, rear_x=16.865620, rear_y=0.628593)
# State(x=17.461229, y=-0.993278, yaw=-1.226351, v=2.777778, rear_x=16.971602, rear_y=0.371553)
# State(x=17.555028, y=-1.254740, yaw=-1.233591, v=2.777778, rear_x=17.075293, rear_y=0.113600)
# State(x=17.646931, y=-1.516874, yaw=-1.240608, v=2.777778, rear_x=17.176811, rear_y=-0.145201)
# State(x=17.736992, y=-1.779647, yaw=-1.247444, v=2.777778, rear_x=17.276260, rear_y=-0.404792)
# State(x=17.825255, y=-2.043029, yaw=-1.249164, v=2.777778, rear_x=17.366887, rear_y=-0.667384)
# State(x=17.913065, y=-2.306563, yaw=-1.250825, v=2.777778, rear_x=17.456983, rear_y=-0.930158)
# State(x=18.000437, y=-2.570242, yaw=-1.252438, v=2.777778, rear_x=17.546576, rear_y=-1.193103)
# State(x=18.087384, y=-2.834061, yaw=-1.254012, v=2.777778, rear_x=17.635691, rear_y=-1.456210)
# State(x=18.173915, y=-3.098017, yaw=-1.251168, v=2.777778, rear_x=17.718305, rear_y=-1.721457)
# State(x=18.261197, y=-3.361726, yaw=-1.248415, v=2.777778, rear_x=17.801799, rear_y=-1.986425)
# State(x=18.349204, y=-3.625194, yaw=-1.245737, v=2.777778, rear_x=17.886124, rear_y=-2.251128)
# State(x=18.437917, y=-3.888425, yaw=-1.243118, v=2.777778, rear_x=17.971240, rear_y=-2.515577)
# State(x=18.527318, y=-4.151423, yaw=-1.236824, v=2.777778, rear_x=18.052010, rear_y=-2.781539)
# State(x=18.618373, y=-4.413853, yaw=-1.230718, v=2.777778, rear_x=18.134710, rear_y=-3.046896)
# State(x=18.711029, y=-4.675722, yaw=-1.224765, v=2.777778, rear_x=18.219237, rear_y=-3.311669)
# State(x=18.805242, y=-4.937035, yaw=-1.215903, v=2.777778, rear_x=18.301382, rear_y=-3.577393)
# State(x=18.901767, y=-5.197502, yaw=-1.207324, v=2.777778, rear_x=18.386261, rear_y=-3.842234)
# State(x=19.000523, y=-5.457132, yaw=-1.198979, v=2.777778, rear_x=18.473725, rear_y=-4.106213)
# State(x=19.101443, y=-5.715929, yaw=-1.190817, v=2.777778, rear_x=18.563636, rear_y=-4.369354)
# State(x=19.204471, y=-5.973894, yaw=-1.180226, v=2.777778, rear_x=18.652433, rear_y=-4.633090)
# State(x=19.310225, y=-6.230753, yaw=-1.169937, v=2.777778, rear_x=18.744422, rear_y=-4.895700)
# State(x=19.418617, y=-6.486510, yaw=-1.159892, v=2.777778, rear_x=18.839431, rear_y=-5.157208)
# State(x=19.529572, y=-6.741165, yaw=-1.150028, v=2.777778, rear_x=18.937303, rear_y=-5.417641)
# State(x=19.643033, y=-6.994714, yaw=-1.135601, v=2.777778, rear_x=19.031731, rear_y=-5.679872)
# State(x=19.760141, y=-7.246600, yaw=-1.121706, v=2.777778, rear_x=19.130629, rear_y=-5.940378)
# State(x=19.880737, y=-7.496834, yaw=-1.108269, v=2.777778, rear_x=19.233732, rear_y=-6.199188)
# State(x=20.004685, y=-7.745425, yaw=-1.095216, v=2.777778, rear_x=19.340796, rear_y=-6.456335)
# State(x=20.131867, y=-7.992377, yaw=-1.079881, v=2.777778, rear_x=19.448288, rear_y=-6.713619)
# State(x=20.262820, y=-8.237349, yaw=-1.065027, v=2.777778, rear_x=19.560323, rear_y=-6.968887)
# State(x=20.397398, y=-8.480350, yaw=-1.050570, v=2.777778, rear_x=19.676638, rear_y=-7.222175)
# State(x=20.535475, y=-8.721379, yaw=-1.033359, v=2.777778, rear_x=19.793168, rear_y=-7.475795)
# State(x=20.677680, y=-8.959997, yaw=-1.016640, v=2.777778, rear_x=19.914651, rear_y=-7.726998)
# State(x=20.823854, y=-9.196204, yaw=-1.000317, v=2.777778, rear_x=20.040802, rear_y=-7.975823)
# State(x=20.973864, y=-9.429993, yaw=-0.984291, v=2.777778, rear_x=20.171356, rear_y=-8.222317)
# State(x=21.127601, y=-9.661349, yaw=-0.959856, v=2.777778, rear_x=20.295826, rear_y=-8.473641)
# State(x=21.286945, y=-9.888879, yaw=-0.936117, v=2.777778, rear_x=20.427211, rear_y=-8.721250)
# State(x=21.451644, y=-10.112563, yaw=-0.912942, v=2.777778, rear_x=20.565085, rear_y=-8.965169)
# State(x=21.621483, y=-10.332370, yaw=-0.876928, v=2.777778, rear_x=20.694186, rear_y=-9.217642)
# State(x=21.799127, y=-10.545920, yaw=-0.841961, v=2.777778, rear_x=20.833425, rear_y=-9.464291)
# State(x=21.984127, y=-10.753128, yaw=-0.807864, v=2.777778, rear_x=20.982113, rear_y=-9.705050)
# State(x=22.176084, y=-10.953910, yaw=-0.765499, v=2.777778, rear_x=21.130580, rear_y=-9.949209)
# State(x=22.376371, y=-11.146381, yaw=-0.724099, v=2.777778, rear_x=21.290181, rear_y=-10.185813)
# State(x=22.584454, y=-11.330398, yaw=-0.683452, v=2.777778, rear_x=21.460128, rear_y=-10.414761)
# State(x=22.799842, y=-11.505807, yaw=-0.621444, v=2.777778, rear_x=21.620937, rear_y=-10.661602)
# State(x=23.025686, y=-11.667532, yaw=-0.561006, v=2.777778, rear_x=21.797942, rear_y=-10.896077)
# State(x=23.260886, y=-11.815321, yaw=-0.501917, v=2.777778, rear_x=21.989726, rear_y=-11.117716)
# State(x=23.504403, y=-11.948961, yaw=-0.432674, v=2.777778, rear_x=22.188024, rear_y=-11.340976)
# State(x=23.756583, y=-12.065434, yaw=-0.365178, v=2.777778, rear_x=22.402196, rear_y=-11.547617)
# State(x=24.016044, y=-12.164632, yaw=-0.299219, v=2.777778, rear_x=22.630472, rear_y=-11.737210)
# State(x=24.281480, y=-12.246514, yaw=-0.224734, v=2.777778, rear_x=22.867942, rear_y=-11.923386)
# State(x=24.552272, y=-12.308416, yaw=-0.152340, v=2.777778, rear_x=23.119065, rear_y=-12.088377)
# State(x=24.826833, y=-12.350569, yaw=-0.081852, v=2.777778, rear_x=23.381688, rear_y=-12.232016)
# State(x=25.103681, y=-12.373281, yaw=-0.013076, v=2.777778, rear_x=23.653805, rear_y=-12.354321)
# State(x=25.381435, y=-12.376913, yaw=0.061240, v=2.777778, rear_x=23.934153, rear_y=-12.465655)
# State(x=25.658692, y=-12.359912, yaw=0.133201, v=2.777778, rear_x=24.221536, rear_y=-12.552484)
# State(x=25.934009, y=-12.323021, yaw=0.202987, v=2.777778, rear_x=24.513779, rear_y=-12.615335)
# State(x=26.206084, y=-12.267022, yaw=0.270786, v=2.777778, rear_x=24.808920, rear_y=-12.654881)
# State(x=26.473740, y=-12.192720, yaw=0.336797, v=2.777778, rear_x=25.105204, rear_y=-12.671896)
# State(x=26.735911, y=-12.100924, yaw=0.404439, v=2.777778, rear_x=25.402892, rear_y=-12.671503)
# State(x=26.991279, y=-11.991617, yaw=0.469675, v=2.777778, rear_x=25.698292, rear_y=-12.647883)
# State(x=27.238978, y=-11.865896, yaw=0.532701, v=2.777778, rear_x=25.989891, rear_y=-12.602295)
# State(x=27.478266, y=-11.724824, yaw=0.593715, v=2.777778, rear_x=26.276407, rear_y=-12.536017)
# State(x=27.708507, y=-11.569422, yaw=0.652924, v=2.777778, rear_x=26.556757, rear_y=-12.450314)
# State(x=27.929149, y=-11.400669, yaw=0.710072, v=2.777778, rear_x=26.829593, rear_y=-12.345908)
# State(x=28.139792, y=-11.219589, yaw=0.764953, v=2.777778, rear_x=27.093741, rear_y=-12.223719)
# State(x=28.340185, y=-11.027227, yaw=0.817767, v=2.777778, rear_x=27.348599, rear_y=-12.085177)
# State(x=28.530144, y=-10.824555, yaw=0.868716, v=2.777778, rear_x=27.593723, rear_y=-11.931630)
# State(x=28.709535, y=-10.612471, yaw=0.918003, v=2.777778, rear_x=27.828794, rear_y=-11.764337)
# State(x=28.878259, y=-10.391807, yaw=0.965833, v=2.777778, rear_x=28.053598, rear_y=-11.584466)
# State(x=29.036241, y=-10.163329, yaw=1.007993, v=2.777778, rear_x=28.262580, rear_y=-11.389685)
# State(x=29.184451, y=-9.928395, yaw=1.048434, v=2.777778, rear_x=28.461004, rear_y=-11.185027)
# State(x=29.323043, y=-9.687660, yaw=1.087336, v=2.777778, rear_x=28.649017, rear_y=-10.971479)
# State(x=29.452167, y=-9.441718, yaw=1.120228, v=2.777778, rear_x=28.820724, rear_y=-10.747008)
# State(x=29.573133, y=-9.191663, yaw=1.151533, v=2.777778, rear_x=28.982855, rear_y=-10.516077)
# State(x=29.686212, y=-8.937944, yaw=1.181405, v=2.777778, rear_x=29.135756, rear_y=-10.279397)
# State(x=29.791664, y=-8.680960, yaw=1.209990, v=2.777778, rear_x=29.279772, rear_y=-10.037598)
# State(x=29.889727, y=-8.421068, yaw=1.237430, v=2.777778, rear_x=29.415250, rear_y=-9.791240)
# State(x=29.980623, y=-8.158583, yaw=1.263863, v=2.777778, rear_x=29.542525, rear_y=-9.540816)
# State(x=30.064550, y=-7.893787, yaw=1.289423, v=2.777778, rear_x=29.661921, rear_y=-9.286766)
# State(x=30.141683, y=-7.626933, yaw=1.314244, v=2.777778, rear_x=29.773750, rear_y=-9.029475)
# State(x=30.212168, y=-7.358247, yaw=1.330574, v=2.777778, rear_x=29.867185, rear_y=-8.766610)
# State(x=30.278256, y=-7.088445, yaw=1.346217, v=2.777778, rear_x=29.955347, rear_y=-8.502033)
# State(x=30.340116, y=-6.817643, yaw=1.361258, v=2.777778, rear_x=30.038504, rear_y=-8.235927)
# State(x=30.397897, y=-6.545941, yaw=1.375776, v=2.777778, rear_x=30.116906, rear_y=-7.968455)
# State(x=30.451726, y=-6.273429, yaw=1.389852, v=2.777778, rear_x=30.190786, rear_y=-7.699757)
# State(x=30.501715, y=-6.000186, yaw=1.396291, v=2.777778, rear_x=30.249964, rear_y=-7.428164)
# State(x=30.549943, y=-5.726627, yaw=1.402446, v=2.777778, rear_x=30.306986, rear_y=-7.156128)
# State(x=30.596486, y=-5.452776, yaw=1.408350, v=2.777778, rear_x=30.361974, rear_y=-6.883687)
# State(x=30.641412, y=-5.178656, yaw=1.414036, v=2.777778, rear_x=30.415039, rear_y=-6.610876)
# State(x=30.684778, y=-4.904284, yaw=1.419535, v=2.777778, rear_x=30.466284, rear_y=-6.337728)
# State(x=30.726636, y=-4.629678, yaw=1.419065, v=2.777778, rear_x=30.507468, rear_y=-6.063019)
# State(x=30.768622, y=-4.355092, yaw=1.418617, v=2.777778, rear_x=30.548812, rear_y=-5.788334)
# State(x=30.810731, y=-4.080524, yaw=1.418188, v=2.777778, rear_x=30.590307, rear_y=-5.513672)
# State(x=30.852958, y=-3.805975, yaw=1.417777, v=2.777778, rear_x=30.631944, rear_y=-5.239032)
# State(x=30.895297, y=-3.531443, yaw=1.417380, v=2.777778, rear_x=30.673716, rear_y=-4.964412)
# State(x=30.937746, y=-3.256927, yaw=1.412916, v=2.777778, rear_x=30.709769, rear_y=-4.688893)
# State(x=30.981420, y=-2.982604, yaw=1.408672, v=2.777778, rear_x=30.747368, rear_y=-4.413590)
# State(x=31.026257, y=-2.708469, yaw=1.404626, v=2.777778, rear_x=30.786417, rear_y=-4.138496)
# State(x=31.072204, y=-2.434518, yaw=1.400755, v=2.777778, rear_x=30.826830, rear_y=-3.863606)
# State(x=31.119210, y=-2.160746, yaw=1.397039, v=2.777778, rear_x=30.868528, rear_y=-3.588912)
# State(x=31.167233, y=-1.887151, yaw=1.393457, v=2.777778, rear_x=30.911437, rear_y=-3.314410)
# State(x=31.216237, y=-1.613730, yaw=1.389989, v=2.777778, rear_x=30.955493, rear_y=-3.040093)
# State(x=31.266187, y=-1.340480, yaw=1.386616, v=2.777778, rear_x=31.000634, rear_y=-2.765956)
# State(x=31.317060, y=-1.067401, yaw=1.383318, v=2.777778, rear_x=31.046806, rear_y=-2.491993)
# State(x=31.368833, y=-0.794490, yaw=1.380073, v=2.777778, rear_x=31.093957, rear_y=-2.218198)
# State(x=31.421491, y=-0.521749, yaw=1.376859, v=2.777778, rear_x=31.142041, rear_y=-1.944566)
# State(x=31.475025, y=-0.249179, yaw=1.370969, v=2.777778, rear_x=31.187200, rear_y=-1.670325)
# State(x=31.530164, y=0.023071, yaw=1.365270, v=2.777778, rear_x=31.234245, rear_y=-1.396412)
# State(x=31.586854, y=0.295003, yaw=1.359731, v=2.777778, rear_x=31.283076, rear_y=-1.122819)
# State(x=31.645049, y=0.566616, yaw=1.354318, v=2.777778, rear_x=31.333601, rear_y=-0.849541)
# State(x=31.704713, y=0.837911, yaw=1.348998, v=2.777778, rear_x=31.385736, rear_y=-0.576569)
# State(x=31.765820, y=1.108884, yaw=1.343734, v=2.777778, rear_x=31.439401, rear_y=-0.303897)
# State(x=31.828352, y=1.379532, yaw=1.337678, v=2.777778, rear_x=31.493385, rear_y=-0.031247)
# State(x=31.892522, y=1.649796, yaw=1.331825, v=2.777778, rear_x=31.549303, rear_y=0.241002)
# State(x=31.958273, y=1.919680, yaw=1.326142, v=2.777778, rear_x=31.607052, rear_y=0.512859)
# State(x=32.025557, y=2.189185, yaw=1.320594, v=2.777778, rear_x=31.666537, rear_y=0.784335)
# State(x=32.094335, y=2.458314, yaw=1.315148, v=2.777778, rear_x=31.727669, rear_y=1.055440)
# State(x=32.164577, y=2.727064, yaw=1.309767, v=2.777778, rear_x=31.790368, rear_y=1.326183)
# State(x=32.236265, y=2.995432, yaw=1.304806, v=2.777778, rear_x=31.855110, rear_y=1.596424)
# State(x=32.309283, y=3.263441, yaw=1.300014, v=2.777778, rear_x=31.921430, rear_y=1.866276)
# State(x=32.383584, y=3.531097, yaw=1.295366, v=2.777778, rear_x=31.989240, rear_y=2.135750)
# State(x=32.459129, y=3.798405, yaw=1.290833, v=2.777778, rear_x=32.058465, rear_y=2.404860)
# State(x=32.535885, y=4.065367, yaw=1.286388, v=2.777778, rear_x=32.129030, rear_y=2.673617)
# State(x=32.613826, y=4.331986, yaw=1.282002, v=2.777778, rear_x=32.200871, rear_y=2.942034)
# State(x=32.692936, y=4.598261, yaw=1.278558, v=2.777778, rear_x=32.275196, rear_y=3.209739)
# State(x=32.772963, y=4.864261, yaw=1.275233, v=2.777778, rear_x=32.350608, rear_y=3.477136)
# State(x=32.853874, y=5.129994, yaw=1.272008, v=2.777778, rear_x=32.427049, rear_y=3.744238)
# State(x=32.935641, y=5.395464, yaw=1.268866, v=2.777778, rear_x=32.504464, rear_y=4.011056)
# State(x=33.018242, y=5.660677, yaw=1.265787, v=2.777778, rear_x=32.582804, rear_y=4.277603)
# State(x=33.101660, y=5.925633, yaw=1.262750, v=2.777778, rear_x=32.662023, rear_y=4.543888)
# State(x=33.185881, y=6.190336, yaw=1.260645, v=2.777778, rear_x=32.743338, rear_y=4.809519)
# State(x=33.270660, y=6.454860, yaw=1.258614, v=2.777778, rear_x=32.825312, rear_y=5.074945)
# State(x=33.355975, y=6.719211, yaw=1.256643, v=2.777778, rear_x=32.907909, rear_y=5.340177)
# State(x=33.441812, y=6.983394, yaw=1.254722, v=2.777778, rear_x=32.991097, rear_y=5.605223)
# State(x=33.528156, y=7.247412, yaw=1.252839, v=2.777778, rear_x=33.074847, rear_y=5.870091)
# State(x=33.614996, y=7.511266, yaw=1.250982, v=2.777778, rear_x=33.159130, rear_y=6.134790)
# State(x=33.702327, y=7.774959, yaw=1.249718, v=2.777778, rear_x=33.244722, rear_y=6.399060)
# State(x=33.789991, y=8.038541, yaw=1.248497, v=2.777778, rear_x=33.330706, rear_y=6.663202)
# State(x=33.877976, y=8.302016, yaw=1.247311, v=2.777778, rear_x=33.417061, rear_y=6.927223)
# State(x=33.966274, y=8.565386, yaw=1.246153, v=2.777778, rear_x=33.503768, rear_y=7.191128)
# State(x=34.054877, y=8.828654, yaw=1.245017, v=2.777778, rear_x=33.590809, rear_y=7.454922)
# State(x=34.143779, y=9.091821, yaw=1.243895, v=2.777778, rear_x=33.678169, rear_y=7.718611)
# State(x=34.232977, y=9.354889, yaw=1.242865, v=2.777778, rear_x=33.765953, rear_y=7.982158)
# State(x=34.322445, y=9.617864, yaw=1.241867, v=2.777778, rear_x=33.854052, rear_y=8.245600)
# State(x=34.412175, y=9.880750, yaw=1.240896, v=2.777778, rear_x=33.942450, rear_y=8.508941)
# State(x=34.502161, y=10.143548, yaw=1.239946, v=2.777778, rear_x=34.031132, rear_y=8.772187)
# State(x=34.592396, y=10.406261, yaw=1.239010, v=2.777778, rear_x=34.120084, rear_y=9.035341)
# State(x=34.682877, y=10.668889, yaw=1.238082, v=2.777778, rear_x=34.209293, rear_y=9.298408)
# State(x=34.773602, y=10.931434, yaw=1.235751, v=2.777778, rear_x=34.296826, rear_y=9.562060)
# State(x=34.864939, y=11.193766, yaw=1.233528, v=2.777778, rear_x=34.385118, rear_y=9.825456)
# State(x=34.956858, y=11.455894, yaw=1.231400, v=2.777778, rear_x=34.474127, rear_y=10.088608)
# State(x=35.049336, y=11.717826, yaw=1.229355, v=2.777778, rear_x=34.563810, rear_y=10.351530)
# State(x=35.142348, y=11.979569, yaw=1.227383, v=2.777778, rear_x=34.654128, rear_y=10.614233)
# State(x=35.235877, y=12.241127, yaw=1.225472, v=2.777778, rear_x=34.745049, rear_y=10.876727)
# State(x=35.329906, y=12.502507, yaw=1.222164, v=2.777778, rear_x=34.834568, rear_y=11.139737)
# State(x=35.424798, y=12.763574, yaw=1.218991, v=2.777778, rear_x=34.925138, rear_y=11.402383)
# State(x=35.520518, y=13.024338, yaw=1.215935, v=2.777778, rear_x=35.016701, rear_y=11.664681)
# State(x=35.617035, y=13.284809, yaw=1.212979, v=2.777778, rear_x=35.109201, rear_y=11.926647)
# State(x=35.714321, y=13.544993, yaw=1.210106, v=2.777778, rear_x=35.202587, rear_y=12.188296)
# State(x=35.812354, y=13.804897, yaw=1.207300, v=2.777778, rear_x=35.296815, rear_y=12.449641)
# State(x=35.911117, y=14.064525, yaw=1.202464, v=2.777778, rear_x=35.389029, rear_y=12.711777)
# State(x=36.011133, y=14.323672, yaw=1.197784, v=2.777778, rear_x=35.482721, rear_y=12.973382)
# State(x=36.112362, y=14.582348, yaw=1.193234, v=2.777778, rear_x=35.577811, rear_y=13.234477)
# State(x=36.214766, y=14.840560, yaw=1.188785, v=2.777778, rear_x=35.674225, rear_y=13.495081)
# State(x=36.318318, y=15.098315, yaw=1.184412, v=2.777778, rear_x=35.771897, rear_y=13.755213)
# State(x=36.422996, y=15.355614, yaw=1.173784, v=2.777778, rear_x=35.862332, rear_y=14.018395)
# State(x=36.530403, y=15.611787, yaw=1.163553, v=2.777778, rear_x=35.956088, rear_y=14.280373)
# State(x=36.640426, y=15.866847, yaw=1.153662, v=2.777778, rear_x=36.052970, rear_y=14.541179)
# State(x=36.752965, y=16.120806, yaw=1.144057, v=2.777778, rear_x=36.152804, rear_y=14.800842)
# State(x=36.867939, y=16.373673, yaw=1.134682, v=2.777778, rear_x=36.255428, rear_y=15.059393)
# State(x=36.985278, y=16.625451, yaw=1.114881, v=2.777778, rear_x=36.346865, rear_y=15.323556)
# State(x=37.107579, y=16.874856, yaw=1.095749, v=2.777778, rear_x=36.444377, rear_y=15.585412)
# State(x=37.234629, y=17.121875, yaw=1.077183, v=2.777778, rear_x=36.547603, rear_y=15.844967)
# State(x=37.366243, y=17.366494, yaw=1.059079, v=2.777778, rear_x=36.656214, rear_y=16.102232)
# State(x=37.502264, y=17.608690, yaw=1.041329, v=2.777778, rear_x=36.769907, rear_y=16.357229)
# State(x=37.642562, y=17.848433, yaw=1.004797, v=2.777778, rear_x=36.864986, rear_y=16.624556)
# State(x=37.791523, y=18.082892, yaw=0.969076, v=2.777778, rear_x=36.970734, rear_y=16.887566)
# State(x=37.948762, y=18.311882, yaw=0.933973, v=2.777778, rear_x=37.086528, rear_y=17.146098)
# State(x=38.113941, y=18.535212, yaw=0.899283, v=2.777778, rear_x=37.211792, rear_y=17.400035)
# State(x=38.286767, y=18.752679, yaw=0.833563, v=2.777778, rear_x=37.312016, rear_y=17.679199)
# State(x=38.473501, y=18.958327, yaw=0.768874, v=2.777778, rear_x=37.431394, rear_y=17.950104)
# State(x=38.673138, y=19.151473, yaw=0.704971, v=2.777778, rear_x=37.568774, rear_y=18.211856)
# State(x=38.884702, y=19.331476, yaw=0.624463, v=2.777778, rear_x=37.708350, rear_y=18.483717)
# State(x=39.110057, y=19.493882, yaw=0.545290, v=2.777778, rear_x=37.870340, rear_y=18.741816)
# State(x=39.347550, y=19.637956, yaw=0.467269, v=2.777778, rear_x=38.052988, rear_y=18.984804)
# State(x=39.595551, y=19.763081, yaw=0.376688, v=2.777778, rear_x=38.247213, rear_y=19.229710)
# State(x=39.853853, y=19.865260, yaw=0.288151, v=2.777778, rear_x=38.463635, rear_y=19.453199)
# State(x=40.120178, y=19.944199, yaw=0.201560, v=2.777778, rear_x=38.699533, rear_y=19.653912)
# State(x=40.392333, y=19.999809, yaw=0.116796, v=2.777778, rear_x=38.952211, rear_y=19.830840)
# State(x=40.668218, y=20.032179, yaw=0.033725, v=2.777778, rear_x=39.219042, rear_y=19.983286)
# State(x=40.945838, y=20.041545, yaw=-0.055213, v=2.777778, rear_x=39.498047, rear_y=20.121564)
# State(x=41.223192, y=20.026216, yaw=-0.141469, v=2.777778, rear_x=39.787678, rear_y=20.230662)
# State(x=41.498195, y=19.987050, yaw=-0.225135, v=2.777778, rear_x=40.084787, rear_y=20.310745)
# State(x=41.768963, y=19.925039, yaw=-0.306328, v=2.777778, rear_x=40.386464, rear_y=20.362301)
# State(x=42.033809, y=19.841273, yaw=-0.385182, v=2.777778, rear_x=40.690051, rear_y=20.386078)
# State(x=42.291234, y=19.736904, yaw=-0.464056, v=2.777778, rear_x=40.994580, rear_y=20.385893)
# State(x=42.539635, y=19.612576, yaw=-0.539778, v=2.777778, rear_x=41.295792, rear_y=20.357797)
# State(x=42.777920, y=19.469814, yaw=-0.612494, v=2.777778, rear_x=41.591505, rear_y=20.303433)
# State(x=43.005202, y=19.310116, yaw=-0.682368, v=2.777778, rear_x=41.879884, rear_y=20.224534)
# State(x=43.220780, y=19.134941, yaw=-0.749576, v=2.777778, rear_x=42.159413, rear_y=20.122867)
# State(x=43.424107, y=18.945683, yaw=-0.814304, v=2.777778, rear_x=42.428864, rear_y=20.000192)
# State(x=43.614767, y=18.743669, yaw=-0.874053, v=2.777778, rear_x=42.684268, rear_y=19.855727)
# State(x=43.793023, y=18.530631, yaw=-0.930882, v=2.777778, rear_x=42.927189, rear_y=19.693744)
# State(x=43.958892, y=18.307813, yaw=-0.984990, v=2.777778, rear_x=43.157229, rear_y=19.516050)
# State(x=44.112467, y=18.076350, yaw=-1.036582, v=2.777778, rear_x=43.374178, rear_y=19.324320)
# State(x=44.253902, y=17.837275, yaw=-1.085855, v=2.777778, rear_x=43.577975, rear_y=19.120094)
# State(x=44.383390, y=17.591525, yaw=-1.133008, v=2.777778, rear_x=43.768680, rear_y=18.904777)
# State(x=44.501151, y=17.339944, yaw=-1.178234, v=2.777778, rear_x=43.946443, rear_y=18.679645)
# State(x=44.607416, y=17.083296, yaw=-1.221725, v=2.777778, rear_x=44.111480, rear_y=18.445848)
# State(x=44.702423, y=16.822271, yaw=-1.263671, v=2.777778, rear_x=44.264060, rear_y=18.204420)
# State(x=44.786401, y=16.557491, yaw=-1.295101, v=2.777778, rear_x=44.391688, rear_y=17.952734)
# State(x=44.862016, y=16.290203, yaw=-1.324970, v=2.777778, rear_x=44.509147, rear_y=17.696611)
# State(x=44.929616, y=16.020776, yaw=-1.353425, v=2.777778, rear_x=44.616903, rear_y=17.436655)
# State(x=44.989522, y=15.749535, yaw=-1.380608, v=2.777778, rear_x=44.715409, rear_y=17.173390)
# State(x=45.042035, y=15.476766, yaw=-1.406655, v=2.777778, rear_x=44.805097, rear_y=16.907277)
# State(x=45.087425, y=15.202722, yaw=-1.431697, v=2.777778, rear_x=44.886381, rear_y=16.638717)
# State(x=45.125939, y=14.927627, yaw=-1.455863, v=2.777778, rear_x=44.959652, rear_y=16.368061)
# State(x=45.157795, y=14.651682, yaw=-1.479278, v=2.777778, rear_x=45.025279, rear_y=16.095614)
# State(x=45.183181, y=14.375067, yaw=-1.502069, v=2.777778, rear_x=45.083606, rear_y=15.821644)
# State(x=45.202257, y=14.097945, yaw=-1.524366, v=2.777778, rear_x=45.134958, rear_y=15.546382)
# State(x=45.215150, y=13.820467, yaw=-1.532260, v=2.777778, rear_x=45.159286, rear_y=15.269390)
# State(x=45.225852, y=13.542895, yaw=-1.539824, v=2.777778, rear_x=45.180948, rear_y=14.992200)
# State(x=45.234454, y=13.265250, yaw=-1.547098, v=2.777778, rear_x=45.200094, rear_y=14.714843)
# State(x=45.241036, y=12.987551, yaw=-1.554122, v=2.777778, rear_x=45.216860, rear_y=14.437349)
# State(x=45.245668, y=12.709812, yaw=-1.560937, v=2.777778, rear_x=45.231372, rear_y=14.159741)
# State(x=45.248406, y=12.432047, yaw=-1.567581, v=2.777778, rear_x=45.243744, rear_y=13.882040)
# State(x=45.249299, y=12.154271, yaw=-1.563458, v=2.777778, rear_x=45.238660, rear_y=13.604232)
# State(x=45.251338, y=11.876501, yaw=-1.559526, v=2.777778, rear_x=45.234995, rear_y=13.326408)
# State(x=45.254468, y=11.598740, yaw=-1.555761, v=2.777778, rear_x=45.232668, rear_y=13.048577)
# State(x=45.258645, y=11.320994, yaw=-1.552144, v=2.777778, rear_x=45.231600, rear_y=12.770742)
# State(x=45.263826, y=11.043265, yaw=-1.548655, v=2.777778, rear_x=45.231723, rear_y=12.492909)
# State(x=45.269976, y=10.765555, yaw=-1.545275, v=2.777778, rear_x=45.232973, rear_y=12.215083)
# State(x=45.277064, y=10.487868, yaw=-1.535720, v=2.777778, rear_x=45.226214, rear_y=11.936976)
# State(x=45.286806, y=10.210261, yaw=-1.526653, v=2.777778, rear_x=45.222818, rear_y=11.658848)
# State(x=45.299064, y=9.932754, yaw=-1.518024, v=2.777778, rear_x=45.222580, rear_y=11.380735)
# State(x=45.313716, y=9.655362, yaw=-1.509787, v=2.777778, rear_x=45.225308, rear_y=11.102665)
# State(x=45.330652, y=9.378101, yaw=-1.501898, v=2.777778, rear_x=45.230829, rear_y=10.824661)
# State(x=45.349776, y=9.100983, yaw=-1.494313, v=2.777778, rear_x=45.238983, rear_y=10.546744)
# State(x=45.371000, y=8.824017, yaw=-1.486992, v=2.777778, rear_x=45.249626, rear_y=10.268928)
# State(x=45.394252, y=8.547214, yaw=-1.477220, v=2.777778, rear_x=45.258765, rear_y=9.990870)
# State(x=45.420207, y=8.270652, yaw=-1.467979, v=2.777778, rear_x=45.271385, rear_y=9.712994)
# State(x=45.448718, y=7.994341, yaw=-1.459216, v=2.777778, rear_x=45.287261, rear_y=9.435324)
# State(x=45.479648, y=7.718290, yaw=-1.450883, v=2.777778, rear_x=45.306190, rear_y=9.157878)
# State(x=45.512877, y=7.442507, yaw=-1.442935, v=2.777778, rear_x=45.327984, rear_y=8.880671)
# State(x=45.548298, y=7.166997, yaw=-1.435330, v=2.777778, rear_x=45.352472, rear_y=8.603713)
# State(x=45.585812, y=6.891764, yaw=-1.428026, v=2.777778, rear_x=45.379498, rear_y=8.327011)
# State(x=45.625336, y=6.616813, yaw=-1.420984, v=2.777778, rear_x=45.408920, rear_y=8.050571)
# State(x=45.666795, y=6.342146, yaw=-1.414001, v=2.777778, rear_x=45.440372, rear_y=7.774359)
# State(x=45.710171, y=6.067776, yaw=-1.407405, v=2.777778, rear_x=45.474307, rear_y=7.498464)
# State(x=45.755356, y=5.793698, yaw=-1.401161, v=2.777778, rear_x=45.510562, rear_y=7.222885)
# State(x=45.802251, y=5.519907, yaw=-1.395233, v=2.777778, rear_x=45.548990, rear_y=6.947618)
# State(x=45.850769, y=5.246399, yaw=-1.389589, v=2.777778, rear_x=45.589453, rear_y=6.672658)
# State(x=45.900829, y=4.973170, yaw=-1.384198, v=2.777778, rear_x=45.631828, rear_y=6.397999)
# State(x=45.952362, y=4.700214, yaw=-1.379030, v=2.777778, rear_x=45.676002, rear_y=6.123634)
# State(x=46.005304, y=4.427528, yaw=-1.374972, v=2.777778, rear_x=45.723170, rear_y=5.849815)
# State(x=46.059353, y=4.155059, yaw=-1.371154, v=2.777778, rear_x=45.771791, rear_y=5.576259)
# State(x=46.114441, y=3.882799, yaw=-1.367555, v=2.777778, rear_x=45.821766, rear_y=5.302954)
# State(x=46.170509, y=3.610738, yaw=-1.364154, v=2.777778, rear_x=45.873006, rear_y=5.029890)
# State(x=46.227502, y=3.338870, yaw=-1.360931, v=2.777778, rear_x=45.925427, rear_y=4.757056)
# State(x=46.285371, y=3.067187, yaw=-1.357870, v=2.777778, rear_x=45.978955, rear_y=4.484441)
# State(x=46.344071, y=2.795682, yaw=-1.354952, v=2.777778, rear_x=46.033522, rear_y=4.212037)
# State(x=46.403564, y=2.524350, yaw=-1.352163, v=2.777778, rear_x=46.089065, rear_y=3.939833)
# State(x=46.463812, y=2.253185, yaw=-1.349487, v=2.777778, rear_x=46.145527, rear_y=3.667821)
# State(x=46.524787, y=1.982182, yaw=-1.346910, v=2.777778, rear_x=46.202856, rear_y=3.395993)
# State(x=46.586459, y=1.711337, yaw=-1.344416, v=2.777778, rear_x=46.261004, rear_y=3.124341)
# State(x=46.648807, y=1.440647, yaw=-1.341993, v=2.777778, rear_x=46.319929, rear_y=2.852858)
# State(x=46.711810, y=1.170108, yaw=-1.339626, v=2.777778, rear_x=46.379590, rear_y=2.581537)
# State(x=46.775454, y=0.899720, yaw=-1.337299, v=2.777778, rear_x=46.439951, rear_y=2.310371)
# State(x=46.839726, y=0.629480, yaw=-1.334998, v=2.777778, rear_x=46.500978, rear_y=2.039356)
# State(x=46.904621, y=0.359389, yaw=-1.332704, v=2.777778, rear_x=46.562639, rear_y=1.768484)
# State(x=46.970134, y=0.089447, yaw=-1.330398, v=2.777778, rear_x=46.624905, rear_y=1.497750)
# State(x=47.036270, y=-0.180343, yaw=-1.330740, v=2.777778, rear_x=46.691522, rear_y=1.228078)
# State(x=47.102314, y=-0.450155, yaw=-1.331069, v=2.777778, rear_x=46.758029, rear_y=0.958379)
# State(x=47.168269, y=-0.719989, yaw=-1.331388, v=2.777778, rear_x=46.824433, rear_y=0.688655)
# State(x=47.234138, y=-0.989844, yaw=-1.331698, v=2.777778, rear_x=46.890739, rear_y=0.418906)
# State(x=47.299923, y=-1.259720, yaw=-1.332001, v=2.777778, rear_x=46.956952, rear_y=0.149135)
# State(x=47.365626, y=-1.529615, yaw=-1.332300, v=2.777778, rear_x=47.023075, rear_y=-0.120659)
# State(x=47.431249, y=-1.799530, yaw=-1.332595, v=2.777778, rear_x=47.089115, rear_y=-0.390472)
# State(x=47.496792, y=-2.069465, yaw=-1.332890, v=2.777778, rear_x=47.155073, rear_y=-0.660306)
# State(x=47.562255, y=-2.339419, yaw=-1.334620, v=2.777778, rear_x=47.222974, rear_y=-0.929671)
# State(x=47.627252, y=-2.609485, yaw=-1.336281, v=2.777778, rear_x=47.290313, rear_y=-1.199176)
# State(x=47.691799, y=-2.879659, yaw=-1.337884, v=2.777778, rear_x=47.357121, rear_y=-1.468812)
# State(x=47.755914, y=-3.149937, yaw=-1.339436, v=2.777778, rear_x=47.423427, rear_y=-1.738571)
# State(x=47.819609, y=-3.420313, yaw=-1.340948, v=2.777778, rear_x=47.489255, rear_y=-2.008447)
# State(x=47.882895, y=-3.690786, yaw=-1.342427, v=2.777778, rear_x=47.554630, rear_y=-2.278432)
# State(x=47.945781, y=-3.961351, yaw=-1.343884, v=2.777778, rear_x=47.619575, rear_y=-2.548521)
# State(x=48.008272, y=-4.232009, yaw=-1.345329, v=2.777778, rear_x=47.684108, rear_y=-2.818708)
# State(x=48.070373, y=-4.502756, yaw=-1.346773, v=2.777778, rear_x=47.748250, rear_y=-3.088989)
# State(x=48.132082, y=-4.773592, yaw=-1.348472, v=2.777778, rear_x=47.812361, rear_y=-3.359280)
# State(x=48.193332, y=-5.044533, yaw=-1.350105, v=2.777778, rear_x=47.875920, rear_y=-3.629701)
# State(x=48.254139, y=-5.315574, yaw=-1.351681, v=2.777778, rear_x=47.938958, rear_y=-3.900243)
# State(x=48.314518, y=-5.586710, yaw=-1.353210, v=2.777778, rear_x=48.001502, rear_y=-4.170899)
# State(x=48.374483, y=-5.857938, yaw=-1.354701, v=2.777778, rear_x=48.063577, rear_y=-4.441662)
# State(x=48.434043, y=-6.129255, yaw=-1.356161, v=2.777778, rear_x=48.125206, rear_y=-4.712527)
# State(x=48.493207, y=-6.400659, yaw=-1.357601, v=2.777778, rear_x=48.186411, rear_y=-4.983488)
# State(x=48.551981, y=-6.672148, yaw=-1.359032, v=2.777778, rear_x=48.247212, rear_y=-5.254539)
# State(x=48.610365, y=-6.943721, yaw=-1.360464, v=2.777778, rear_x=48.307627, rear_y=-5.525677)
# State(x=48.668361, y=-7.215377, yaw=-1.361338, v=2.777778, rear_x=48.366863, rear_y=-5.797068)
# """
df = pd.read_csv('xy.csv')           # 自动识别表头 X,Y
cx, cy = df['X'].to_numpy(), df['Y'].to_numpy()

# Vehicle parameters
LENGTH = 4.5  # [m]
WIDTH = 2.0  # [m]
BACKTOWHEEL = 1.0  # [m]
WHEEL_LEN = 0.3  # [m]
WHEEL_WIDTH = 0.2  # [m]
TREAD = 0.7  # [m]
WB = 2.5  # [m]

def plot_car(x, y, yaw, steer=0.0, cabcolor="-r", truckcolor="-k"):  # pragma: no cover
    outline = np.array([[-BACKTOWHEEL, (LENGTH - BACKTOWHEEL), (LENGTH - BACKTOWHEEL), -BACKTOWHEEL, -BACKTOWHEEL],
                        [WIDTH / 2, WIDTH / 2, - WIDTH / 2, -WIDTH / 2, WIDTH / 2]])

    fr_wheel = np.array([[WHEEL_LEN, -WHEEL_LEN, -WHEEL_LEN, WHEEL_LEN, WHEEL_LEN],
                         [-WHEEL_WIDTH - TREAD, -WHEEL_WIDTH - TREAD, WHEEL_WIDTH - TREAD, WHEEL_WIDTH - TREAD, -WHEEL_WIDTH - TREAD]])

    rr_wheel = np.copy(fr_wheel)

    fl_wheel = np.copy(fr_wheel)
    fl_wheel[1, :] *= -1
    rl_wheel = np.copy(rr_wheel)
    rl_wheel[1, :] *= -1

    Rot1 = np.array([[math.cos(yaw), math.sin(yaw)],
                     [-math.sin(yaw), math.cos(yaw)]])
    Rot2 = np.array([[math.cos(steer), math.sin(steer)],
                     [-math.sin(steer), math.cos(steer)]])

    fr_wheel = (fr_wheel.T.dot(Rot2)).T
    fl_wheel = (fl_wheel.T.dot(Rot2)).T
    fr_wheel[0, :] += WB
    fl_wheel[0, :] += WB

    fr_wheel = (fr_wheel.T.dot(Rot1)).T
    fl_wheel = (fl_wheel.T.dot(Rot1)).T

    outline = (outline.T.dot(Rot1)).T
    rr_wheel = (rr_wheel.T.dot(Rot1)).T
    rl_wheel = (rl_wheel.T.dot(Rot1)).T

    outline[0, :] += x
    outline[1, :] += y
    fr_wheel[0, :] += x
    fr_wheel[1, :] += y
    rr_wheel[0, :] += x
    rr_wheel[1, :] += y
    fl_wheel[0, :] += x
    fl_wheel[1, :] += y
    rl_wheel[0, :] += x
    rl_wheel[1, :] += y

    plt.plot(np.array(outline[0, :]).flatten(),
             np.array(outline[1, :]).flatten(), truckcolor)
    plt.plot(np.array(fr_wheel[0, :]).flatten(),
             np.array(fr_wheel[1, :]).flatten(), truckcolor)
    plt.plot(np.array(rr_wheel[0, :]).flatten(),
             np.array(rr_wheel[1, :]).flatten(), truckcolor)
    plt.plot(np.array(fl_wheel[0, :]).flatten(),
             np.array(fl_wheel[1, :]).flatten(), truckcolor)
    plt.plot(np.array(rl_wheel[0, :]).flatten(),
             np.array(rl_wheel[1, :]).flatten(), truckcolor)
    plt.plot(x, y, "*")

# 提取 x 和 y
# pattern = r"x=([\d\.-]+), y=([\d\.-]+)"
# ——— 提取所有量 ———
pattern = (
    r"x=([\d\.-]+), y=([\d\.-]+), yaw=([\d\.-]+), "
    r"v=([\d\.-]+), rear_x=([\d\.-]+), rear_y=([\d\.-]+), steering_angle=([\d\.-]+)"
)
matches = re.findall(pattern, log)

x_vals      = [float(x)    for x, y, yaw, v, rear_x, rear_y, steer in matches]
y_vals      = [float(y)    for x, y, yaw, v, rear_x, rear_y, steer in matches]
yaw_vals    = [float(yaw)  for x, y, yaw, v, rear_x, rear_y, steer in matches]
steer_vals  = [float(steer)for x, y, yaw, v, rear_x, rear_y, steer in matches]

# ——— 画图准备 ———
plt.figure()
plt.axis("equal")
plt.grid(True)

# （可选）先把参考路线画一下
plt.plot(cx, cy, ".r", label="course")

# # ——— 动画循环 ———
# for i in range(len(x_vals)):
#     plt.cla()                              # 清空上一帧
#     plt.plot(cx, cy, ".r", label="course")   # 参考路线
#     plt.plot(x_vals[:i+1], y_vals[:i+1], "-b", label="trajectory")  # 已走轨迹

#     # 当前帧的车辆
#     plot_car(
#         x_vals[i],
#         y_vals[i],
#         yaw_vals[i],
#         steer_vals[i],
#         cabcolor="-r",
#         truckcolor="-k"
#     )

#     plt.legend()
#     plt.xlabel("x [m]")
#     plt.ylabel("y [m]")
#     plt.axis("equal")
#     plt.grid(True)
#     plt.pause(0.05)    # 暂停 50 ms，控制播放速度

# 循环结束后，显示完整轨迹图
# 动画循环结束后，清空当前 axes
plt.cla()  
# （也可以用 plt.figure() 新建一张图：plt.figure()）
# 只画底图和完整轨迹
plt.plot(cx, cy, ".r", label="course")
plt.plot(x_vals, y_vals, "-b", label="trajectory")
plt.xlabel("x [m]")
plt.ylabel("y [m]")
plt.axis("equal")
plt.grid(True)
plt.legend()
plt.show()
plt.savefig("path.png" ,dpi=150)

# —— 参数 & 数据 ——  
dt = 0.02                                           # 采样周期 [s]
yaw_arr = np.unwrap(np.asarray(yaw_vals))          # 展平 ±π 跳变
t = np.arange(len(yaw_arr)) * dt                   # 时间序列
# 如果按照这个思路添加一阶惯量呢
#    double delayTime = 10.0 * dt; //延迟时间
#     dYaw = (delayTime * lastdYaw + dt * dYaw) / (delayTime + dt);//航向角的角速度
# —— 1. 先计算“原始”角速度 —— 
# raw_dYaw[i] = (yaw_arr[i] - yaw_arr[i-1]) / dt
raw_dYaw = np.zeros_like(yaw_arr)
raw_dYaw[1:] = np.diff(yaw_arr) / dt
raw_dYaw[0]  = raw_dYaw[1]  # 或者设为 0，看你的需求

# —— 2. 定义一阶惯量（延迟时间 τ = delay_time） —— 
# 你给的 delayTime = 10.0 * dt
tau = 10.0 * dt

# —— 3. 应用一阶惯性滤波 —— 
# filtered_dYaw[n] = (τ * filtered_dYaw[n-1] + dt * raw_dYaw[n]) / (τ + dt)
filtered_dYaw = np.zeros_like(raw_dYaw)
filtered_dYaw[0] = raw_dYaw[0]

for k in range(1, len(raw_dYaw)):
    filtered_dYaw[k] = (tau * filtered_dYaw[k-1] + dt * raw_dYaw[k]) / (tau + dt)

# # 用 Savitzky-Golay 对相位微抖动做去噪
# yaw_smooth = savgol_filter(yaw_raw, 7, 2)   # window=7, poly=2
# yaw_unwrap = np.unwrap(yaw_smooth, discont=np.pi/2)

def windowed_derivative(x, dt, w=5):
    """w 个采样点做最小二乘一次线性回归求斜率，中心位导数"""
    n = len(x)
    deriv = np.empty(n)
    half = w//2
    for i in range(n):
        lo = max(i-half, 0)
        hi = min(i+half+1, n)
        t = np.arange(lo, hi) * dt
        y = x[lo:hi]
        # 去均值防止数值溢出
        t -= t.mean(); y -= y.mean()
        deriv[i] = (t @ y) / (t @ t)
    return deriv

# yaw_dot = windowed_derivative(yaw_arr, dt=0.1, w=9)

# —— 一阶 / 二阶导 ——  
yaw_dot  = np.gradient(yaw_arr, t, edge_order=2)  # ω = ḟ
yaw_ddot = np.gradient(yaw_dot, t, edge_order=2)  # α = ̈f

# （可选）对导数做轻度平滑，减小数值噪声
# yaw_dot_s  = savgol_filter(yaw_dot,  11, 3)      # window=11, poly=3
# yaw_ddot_s = savgol_filter(yaw_ddot, 11, 3)

# —— 绘图：yaw ——  
plt.figure()
plt.plot(t, yaw_arr)
plt.xlabel("time [s]")
plt.ylabel("yaw [rad]")
plt.title("Yaw vs. time")
plt.grid(True)
plt.savefig("yaw.png", dpi=150)

# —— 绘图：yaẇ ——  
plt.figure()
plt.plot(t, raw_dYaw)
plt.xlabel("time [s]")
plt.ylabel("yaw rate [rad/s]")
plt.title("Yaw rate (first derivative)")
plt.grid(True)
plt.savefig("yaw_rate.png", dpi=150)

# —— 绘图：yaẅ ——  
plt.figure()
plt.plot(t, yaw_ddot)
plt.xlabel("time [s]")
plt.ylabel("yaw acceleration [rad/s²]")
plt.title("Yaw acceleration (second derivative)")
plt.grid(True)
plt.savefig("yaw_accel.png", dpi=150)


x = np.asarray(x_vals, dtype=float)
y = np.asarray(y_vals, dtype=float)

# ② 二阶中心差分：a_i = (x_{i+1} - 2·x_i + x_{i-1}) / dt²
acc_x = (x[2:] - 2*x[1:-1] + x[:-2]) / dt**2
acc_y = (y[2:] - 2*y[1:-1] + y[:-2]) / dt**2
frames = np.arange(1, len(x)-1)      # 与加速度对齐的帧序号
acc_mag = np.hypot(acc_x, acc_y)  # 等价于 √(ax² + ay²)
# ③ 作图（1 张图两条曲线，符合“无子图”要求）
plt.figure()
plt.plot(frames, acc_x, label='a_x')
plt.plot(frames, acc_y, label='a_y')
plt.xlabel('Frame index')
plt.ylabel('Acceleration (units/s²)')
plt.title('Per-direction acceleration via 2-frame difference')
plt.legend()
plt.grid(True)
plt.savefig("xy_accel.png", dpi=150)
from matplotlib.ticker import MultipleLocator

plt.figure() 
plt.plot(frames, acc_mag)
plt.xlabel('Frame index'); plt.ylabel('|a| (units/s²)')
plt.title('Acceleration magnitude'); plt.grid(True); plt.tight_layout()
plt.savefig('xy_accel_mag.png', dpi=150)
